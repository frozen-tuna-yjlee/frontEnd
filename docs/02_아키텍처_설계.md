# 아키텍처 설계 문서

## 1. 전체 아키텍처

### 1.1 시스템 구조

```
┌─────────────────────────────────────────────────┐
│              Frontend (React)                    │
│  ┌──────────────────────────────────────────┐  │
│  │         Presentation Layer                │  │
│  │  - Components (UI)                       │  │
│  │  - Layout Components                    │  │
│  │  - Widgets                              │  │
│  └──────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────┐  │
│  │         Business Logic Layer             │  │
│  │  - Context API (AuthContext)             │  │
│  │  - Custom Hooks                          │  │
│  └──────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────┐  │
│  │         Data Access Layer                 │  │
│  │  - Axios Instance                        │  │
│  │  - API Services                          │  │
│  └──────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
                    │
                    │ HTTP/HTTPS
                    │
┌─────────────────────────────────────────────────┐
│           Backend API Server                     │
│         (http://localhost:3000)                  │
└─────────────────────────────────────────────────┘
```

### 1.2 레이어 구조

#### Presentation Layer (표현 계층)
- **역할**: 사용자 인터페이스 렌더링
- **구성요소**:
  - Layout Components (Header, Footer, Sidebar)
  - Section Components (News, Services, Entertainment)
  - Widget Components (Weather, Stock, Trending)
  - Card Components (NewsCard, ServiceCard, EntertainmentCard)
  - Auth Components (LoginPage, KakaoLogin)

#### Business Logic Layer (비즈니스 로직 계층)
- **역할**: 애플리케이션 상태 관리 및 비즈니스 로직 처리
- **구성요소**:
  - AuthContext: 인증 상태 관리
  - Custom Hooks: 재사용 가능한 로직

#### Data Access Layer (데이터 접근 계층)
- **역할**: 백엔드 API와의 통신
- **구성요소**:
  - Axios Instance: HTTP 클라이언트
  - API Services: API 엔드포인트 정의

---

## 2. 컴포넌트 아키텍처

### 2.1 컴포넌트 계층 구조

```
App
├── AuthProvider (Context)
│   └── AppContent
│       ├── Header
│       │   └── LoginPage (Modal)
│       │       └── KakaoLogin
│       ├── MainContent
│       │   ├── SearchSection
│       │   ├── NewsSection
│       │   │   └── NewsCard (Multiple)
│       │   ├── ServicesSection
│       │   │   └── ServiceCard (Multiple)
│       │   ├── EntertainmentSection
│       │   │   └── EntertainmentCard (Multiple)
│       │   └── Sidebar
│       │       ├── ProfileWidget
│       │       ├── WeatherWidget
│       │       ├── StockWidget
│       │       └── TrendingWidget
│       └── Footer
```

### 2.2 컴포넌트 분류

#### Container Components (컨테이너 컴포넌트)
- **App.tsx**: 최상위 컴포넌트, AuthProvider 래핑
- **MainContent.tsx**: 메인 콘텐츠 레이아웃 구성

#### Layout Components (레이아웃 컴포넌트)
- **Header.tsx**: 상단 네비게이션 바
- **Footer.tsx**: 하단 푸터
- **Sidebar.tsx**: 사이드바 레이아웃

#### Feature Components (기능 컴포넌트)
- **SearchSection.tsx**: 검색 섹션
- **NewsSection.tsx**: 뉴스 섹션
- **ServicesSection.tsx**: 서비스 섹션
- **EntertainmentSection.tsx**: 연예/스포츠 섹션

#### Presentational Components (표현 컴포넌트)
- **NewsCard.tsx**: 뉴스 카드
- **ServiceCard.tsx**: 서비스 카드
- **EntertainmentCard.tsx**: 연예/스포츠 카드

#### Widget Components (위젯 컴포넌트)
- **WeatherWidget.tsx**: 날씨 위젯
- **StockWidget.tsx**: 주식 위젯
- **TrendingWidget.tsx**: 실시간 검색어 위젯
- **ProfileWidget.tsx**: 프로필 위젯

#### Auth Components (인증 컴포넌트)
- **LoginPage.tsx**: 로그인 모달
- **KakaoLogin.tsx**: 카카오 로그인 버튼

---

## 3. 상태 관리 아키텍처

### 3.1 전역 상태 관리

#### AuthContext
```typescript
interface AuthContextValue {
  user: User | null;              // 현재 사용자 정보
  isLoading: boolean;             // 로딩 상태
  login: (userId, userPw, rememberMe) => Promise<void>;
  kakaoLogin: (kakaoUserInfo, accessToken) => Promise<void>;
  logout: () => Promise<void>;
  refreshToken: () => Promise<void>;
}
```

#### 상태 흐름
1. **초기화**: 페이지 로드 시 토큰 확인 및 사용자 정보 로드
2. **로그인**: 사용자 인증 후 토큰 저장 및 사용자 정보 설정
3. **토큰 갱신**: 5분마다 자동으로 토큰 health check
4. **로그아웃**: 토큰 제거 및 사용자 정보 초기화

### 3.2 로컬 상태 관리
- 각 컴포넌트는 필요한 경우 `useState`를 사용하여 로컬 상태 관리
- 모달 표시/숨김, 폼 입력값 등

---

## 4. 데이터 흐름

### 4.1 인증 플로우

#### 일반 로그인
```
User Input (LoginPage)
    ↓
login() 호출 (AuthContext)
    ↓
POST /api/auth/login (Axios)
    ↓
토큰 저장 (localStorage)
    ↓
사용자 정보 설정 (AuthContext)
    ↓
UI 업데이트 (Header)
```

#### 카카오 로그인
```
KakaoLogin 버튼 클릭
    ↓
Kakao SDK 로그인
    ↓
카카오 사용자 정보 획득
    ↓
kakaoLogin() 호출 (AuthContext)
    ↓
POST /api/auth/kakao/callback (Axios)
    ↓
토큰 저장 (localStorage)
    ↓
사용자 정보 설정 (AuthContext)
    ↓
UI 업데이트 (Header)
```

### 4.2 API 요청 플로우

```
Component
    ↓
Axios Instance (services/axios.ts)
    ↓
Request Interceptor (토큰 자동 추가)
    ↓
Backend API
    ↓
Response Interceptor (에러 처리)
    ↓
Component (데이터 처리)
```

---

## 5. 보안 아키텍처

### 5.1 인증 토큰 관리
- **저장 위치**: localStorage
- **토큰 키**: `accessToken`
- **전송 방식**: Bearer Token (Authorization 헤더)
- **자동 갱신**: 5분마다 health check

### 5.2 요청 인터셉터
```typescript
// 모든 요청에 자동으로 토큰 추가
axiosInstance.interceptors.request.use((config) => {
  const token = localStorage.getItem('accessToken');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});
```

### 5.3 응답 인터셉터
```typescript
// 401 에러 시 자동 로그아웃 처리
axiosInstance.interceptors.response.use(
  (response) => response,
  async (error) => {
    if (error.response?.status === 401) {
      localStorage.removeItem('accessToken');
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);
```

---

## 6. 스타일링 아키텍처

### 6.1 Tailwind CSS
- 유틸리티 기반 CSS 프레임워크
- 클래스명을 통한 스타일링
- 반응형 디자인 지원 (sm:, md:, lg:, xl:)

### 6.2 CSS 파일 구조
- **index.css**: 글로벌 스타일
- **App.css**: 앱 레벨 스타일
- **컴포넌트별 CSS**: LoginPage.css, Header.css 등

---

## 7. 빌드 및 배포 아키텍처

### 7.1 개발 환경
- **빌드 도구**: Vite
- **개발 서버**: Vite Dev Server
- **HMR**: Hot Module Replacement 지원

### 7.2 프로덕션 빌드
```bash
npm run build
```
- TypeScript 컴파일
- Vite 빌드
- 최적화된 번들 생성

### 7.3 빌드 산출물
- `dist/` 디렉토리에 정적 파일 생성
- HTML, CSS, JavaScript 번들
- 에셋 파일 (이미지, 폰트 등)

---

## 8. 확장성 고려사항

### 8.1 컴포넌트 확장
- 컴포넌트를 작은 단위로 분리하여 재사용성 향상
- Props 인터페이스를 통한 유연한 컴포넌트 설계

### 8.2 API 확장
- Axios 인스턴스를 통한 중앙화된 API 관리
- 새로운 API 엔드포인트 추가 시 서비스 레이어에 추가

### 8.3 상태 관리 확장
- 필요 시 Redux 또는 Zustand 도입 가능
- 현재는 Context API로 충분하지만, 복잡도 증가 시 마이그레이션 고려

---

## 9. 성능 최적화

### 9.1 코드 스플리팅
- 필요 시 React.lazy()를 사용한 동적 임포트
- 라우트 기반 코드 스플리팅 가능

### 9.2 메모이제이션
- useMemo, useCallback을 통한 불필요한 리렌더링 방지
- React.memo를 통한 컴포넌트 메모이제이션

### 9.3 이미지 최적화
- WebP 포맷 사용 고려
- 이미지 지연 로딩 (lazy loading)

---

## 10. 테스트 전략

### 10.1 단위 테스트
- 컴포넌트 단위 테스트 (React Testing Library)
- 유틸리티 함수 테스트

### 10.2 통합 테스트
- API 통합 테스트
- 인증 플로우 테스트

### 10.3 E2E 테스트
- 사용자 시나리오 기반 테스트 (Cypress, Playwright)

